<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/css/main.css" />
    <title>Track Name Page</title>
  </head>
  <body>
    <div class="container card">
      <form class="form" id="nameForm" method="post">
        <h2 class="form__title">Track Name Page</h2>
        <div class="form__field">
          <label for="name">Name</label>
          <input type="text" name="name" id="name" />
        </div>
        <div class="container__btn">
          <button class="form__btn" for="nameForm" type="submit">submit</button>
        </div>
        <div class="link"><a href="/index.html">Back to Home Page</a></div>
      </form>
    </div>

    <script>
      const form = document.querySelector('.form');
      const name = document.querySelector('#name');
      const formTitle = document.querySelector('.form__title');

      form.addEventListener('submit', async (event) => {
        event.preventDefault();
        const nameValue = name.value;

        if (nameValue.trim() === '') {
          return (formTitle.textContent = 'Please Fill the Fields');
        }

        async function sendName(url, name) {
          const response = await fetch(url, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            data: JSON.stringify({ name }),
          });

          // const data = await response.json();
        }

        await sendName(
          `http://localhost:3000/trackName?name=${nameValue}`,
          nameValue
        );

        // 原來問題是在前端的url，我在network明明有看到發送請求跟redirect成功的訊息XD
        window.location.href = '/myName';
      });
    </script>
  </body>
</html>
